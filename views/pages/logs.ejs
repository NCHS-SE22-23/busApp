<!DOCTYPE html>
<html>
    <head>
        <title>NCHS Bus Change Logs</title>

        <link rel="icon" type="image/png" href="images/Naperville_Central_Logo.png">

        <!-- Latest compiled and minified CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

        <!-- Latest compiled JavaScript -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

        <link rel="stylesheet" href="css/logs.css">
        
        <style>
            html {
                height: 100%;
            }          
            body {
                height: 100%;
                margin: 0;
                background-repeat: no-repeat;
                background-attachment: fixed;
                background-color: rgb(249, 254, 255);
                /*background: linear-gradient(180deg, rgba(255,255,255,1) 0%, rgba(204,204,204,1) 100%);*/
                display: block;
                overflow: scroll;
            }
            h1, a {
                color: white;
                font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            }

            table, th, td{
                /*border: 1px solid;*/
                border-bottom: 1px solid rgb(0,0,0);
                padding: 5px;
                margin-left: auto;
                margin-right: auto;
                width: 85%;
                border-collapse: collapse;
                
                table-layout: fixed;
                margin-top: 15px;
                margin-bottom: 15px;
                position: sticky;
            
                
            }
                /*
            table.PerformanceTable {
                table-layout: fixed; 
                width: 500px; 
            }
            table.PerformanceTable tr.PerformanceCell {
                width: 75px;
            }*/
            tr:nth-child(even){background-color: #ebebeb;}
            tr:hover {background-color: #ff928e;}
            th{background-color: rgb(230, 55, 72); color: black;}
        </style>

    </head>

    <body>
        <div id="main-container" class="flex-container" style="display: none;">
            <div id="redbar" class="flex-container">
                    
                    <div id="buslist" class="flex-fill" onclick="location.href='buslist';"><img id="menu-btn" src="images/clipboard.png" alt="Bus List"></div>

                    <div id="buschanges" class="flex-fill" onclick="location.href='buschanges';"><img id="menu-btn" src="images/change.png" alt="Bus Changes"></div>

                    <div id="logs" class="flex-fill" onclick="location.href='logs';" style="cursor:default;"><img id="menu-btn" src="images/log-file-format.png" alt="Logs"></div>

                    <div id="settings" class="flex-fill" onclick="location.href='settings';"><img id="menu-btn" src="images/settings.png" alt="Settings"></div>

                    <div id="logout" class="flex-fill" onclick="location.href='logout';"><img id="menu-btn" src="images/exit.png" alt="Logout"></div>
                    
            </div>
            
            <div id="log_body" class="flex-container">
                <table id="busTable">
                    <thead>
                        <tr>
                            <th>Bus Affected</th> 
                            <th>Action Done</th>
                            <th>Timestamp</th>
                        </tr>
                      </thead>
    
                </table>
            </div> 

            <script>
                function makeTable() {
                    fetch('/getlogs')
                    .then(response => { 
                        if(response.ok) {
                            return response.json(); // not important
                        }
                    }).then(data => {
                        if(data) { // if there is data
                            let i = 0;
                            let busses = data.logs;
                            let table = document.getElementById('busTable');
                            while(i < busses.length) { // busses[i]
                                let row = table.insertRow(1);
                                
                                row.insertCell(0).innerHTML = busses[i].bus;
                                row.insertCell(1).innerHTML = busses[i].description;
                                row.insertCell(2).innerHTML = busses[i].timestamp;
                                i++;
                            }
                            
                        }
                    });
                }
            function fetchBusses() {
                fetch('/getlogs')
                .then(response => { 
                    if(response.ok) {
                        return response.json(); // not important
                    }
                }).then(data => {
                    if(data) { // if there is data
                        let i = 1;
                        let busses = data.logs;
                        let table = document.getElementById('busTable');
                        while(i < busses.length) { // busses[i]
                            let row = table.rows[i];
                            row.insertCell(0).innerHTML = busses[i].bus;
                            row.insertCell(1).innerHTML = busses[i].description;
                            row.insertCell(2).innerHTML = busses[i].timestamp;
                            i++;
                        }
                        
                    }
                });
                
            }
            </script>
        
        <script>
            
            makeTable();
        </script>
            
        
    </body>
    
    <script src="js/logs.js"></script>
    <script>
        let button = document.getElementById('logs'); //invert button colors on webpage select
        button.style.filter = "invert(1)";
        button.style.boxShadow = "0px 7px 14px rgb(237, 237, 237)";
    </script>

</html>